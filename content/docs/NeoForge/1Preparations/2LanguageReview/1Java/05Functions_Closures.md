---
title: "å‡½æ•°ä¸é—­åŒ…"
subtitle: ""
date: 2025-09-03T16:00:30+08:00
categories:
weight: 50
description: ""
keywords: ""
draft: true
author: {name: "wmsnp", link: "https://github.com/wmsnp", avatar: "https://i.ooxx.ooo/i/ZGM0M.jpg"}
---

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä½ å­¦ä¹ çš„éƒ½æ˜¯ Java ä¸­æœ€åŸºç¡€çš„å†…å®¹ï¼šå€¼ã€ç±»å‹ã€å˜é‡ã€ç”šè‡³ç®€å•çš„è¡¨è¾¾å¼å’Œè¿ç®—ã€‚å®ƒä»¬çœ‹èµ·æ¥ç®€å•ï¼Œä¹Ÿå¾ˆç›´è§‚â€”â€”å°±åƒåœ¨ç©ç§¯æœ¨ï¼Œéšæ‰‹ä¸€æ­å°±èƒ½çœ‹åˆ°ç»“æœã€‚

ä½†æ˜¯ï¼Œä»è¿™ä¸€èŠ‚å¼€å§‹ï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œä½ å°†è¿›å…¥ Java ä¸­çœŸæ­£æ ¸å¿ƒçš„æ¦‚å¿µä¹‹ä¸€â€”â€”å‡½æ•°ã€‚å‡½æ•°ä¸ä»…ä»…æ˜¯â€œèƒ½æ‰§è¡Œä¸€æ®µä»£ç â€çš„å·¥å…·ï¼Œå®ƒä»¬æ˜¯ç¨‹åºçš„åŸºæœ¬æ„å»ºå—ï¼Œæ˜¯æŠŠæ€è·¯æŠ½è±¡æˆå¯å¤ç”¨é€»è¾‘çš„æ–¹å¼ã€‚è¿™æ„å‘³ç€ï¼Œæ¯ä¸€ä¸ªå‡½æ•°çš„å†™æ³•ã€æ¯ä¸€ä¸ªå‚æ•°çš„è®¾è®¡ã€æ¯ä¸€æ¬¡è¿”å›å€¼çš„ä½¿ç”¨ï¼Œéƒ½ç›´æ¥å…³ç³»åˆ°ä½ èƒ½å¦ç”¨ Java æ¸…æ™°ã€é«˜æ•ˆåœ°è¡¨è¾¾ä½ çš„æƒ³æ³•ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œåé¢ä½ è¿˜ä¼šå­¦ä¹ åˆ°å¾ˆå¤šçœ‹èµ·æ¥æŠ½è±¡ä½†éå¸¸é‡è¦çš„æ¦‚å¿µâ€”â€”æ— è®ºæ˜¯ç±»ã€æ¥å£ã€æ³›å‹ï¼Œè¿˜æ˜¯æ³¨è§£ã€åå°„ã€äº‹ä»¶ã€‚å®ƒä»¬å¯èƒ½åˆšå¼€å§‹æœ‰äº›éš¾ç†è§£ï¼Œä½†åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šæ·±å…¥åœ°æ¢ç©¶è¿™äº›æ¦‚å¿µå’Œç”¨æ³•ï¼Œç”±æ­¤ä½ å°±èƒ½ç”¨ Java å†™å‡ºç»“æ„æ¸…æ™°ã€çµæ´»ã€é«˜æ•ˆçš„ Mod ä»£ç ã€‚

åˆ«æ‹…å¿ƒï¼Œä½ å·²ç»æŒæ¡äº†åŸºç¡€ç±»å‹å’Œå˜é‡çš„æ¦‚å¿µï¼Œç°åœ¨ä½ åªéœ€è¦æŠŠè¿™äº›åŸºç¡€ç»„åˆèµ·æ¥ï¼Œé€æ­¥ç†è§£å‡½æ•°çš„çœŸæ­£å¨åŠ›â€”â€”ä½ å¾ˆå¿«å°±ä¼šå‘ç°ï¼Œå‡½æ•°ä¸ä»…èƒ½è®©ä»£ç è¿è¡Œï¼Œæ›´èƒ½è®©ä»£ç â€œä¼šæ€è€ƒâ€ã€‚

## å‡½æ•°çš„åŸºæœ¬æ¦‚å¿µ

åœ¨ Java ä¸­ï¼Œå‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ˜¯ä¸€æ®µå¯ä»¥é‡å¤æ‰§è¡Œçš„ä»£ç å—ï¼Œå®ƒæ¥å—è¾“å…¥ï¼ˆå‚æ•°ï¼‰ï¼Œå¹¶è¿”å›è¾“å‡ºï¼ˆè¿”å›å€¼ï¼‰ã€‚ä½ å¯ä»¥æŠŠå‡½æ•°ç†è§£ä¸ºä¸€ä¸ªâ€œæ˜ å°„â€ï¼šè¾“å…¥ â†’ è¾“å‡ºã€‚

ä¸€ä¸ªå‡½æ•°ç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š
```Java {.no-header}
è¿”å›ç±»å‹ å‡½æ•°å(å‚æ•°åˆ—è¡¨) {
    // å‡½æ•°ä½“ï¼šæ‰§è¡Œå…·ä½“æ“ä½œ
    return è¿”å›å€¼;
}
```

+ è¿”å›ç±»å‹ï¼šå‡½æ•°æ‰§è¡Œåäº§ç”Ÿçš„ç»“æœç±»å‹ã€‚å¦‚æœæ²¡æœ‰è¿”å›å€¼ï¼Œåˆ™ä½¿ç”¨ voidï¼›
+ å‡½æ•°åï¼šç”¨æ¥è°ƒç”¨å‡½æ•°çš„æ ‡è¯†ï¼›
+ å‚æ•°åˆ—è¡¨ï¼šå‡½æ•°æ¥æ”¶çš„è¾“å…¥ï¼Œæ¯ä¸ªå‚æ•°éƒ½æœ‰ç±»å‹å’Œåå­—ï¼Œå¤šä¸ªå‚æ•°ç”¨é€—å·åˆ†éš”ï¼›
+ å‡½æ•°ä½“ï¼šåŒ…å«å‡½æ•°è¦æ‰§è¡Œçš„è¯­å¥ï¼›
+ returnï¼šå°†å‡½æ•°çš„ç»“æœè¿”å›ç»™è°ƒç”¨è€…ï¼ˆé void å‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼‰ã€‚

ä¾‹å¦‚ï¼š
```Java
// å®šä¹‰ä¸€ä¸ªå‡½æ•° squareï¼Œæ¥æ”¶ä¸€ä¸ªæ•´æ•° xï¼Œè¿”å› x çš„å¹³æ–¹
static int square(int x) {
    return x * x;
}

public static void main(String[] args) {
    int result = square(5); // è°ƒç”¨ square å‡½æ•°
    System.out.println(result); // è¾“å‡º 25
}
```

åœ¨è¿™é‡Œï¼Œæ— è®ºæ˜¯ä½ åˆšå®šä¹‰çš„`square`ï¼Œè¿˜æ˜¯ç³»ç»Ÿå†…ç½®çš„`println`ï¼Œéƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ä¸éš¾çœ‹å‡ºï¼Œè°ƒç”¨å‡½æ•°çš„æ–¹å¼ä¹Ÿå¾ˆç®€å•ï¼š
```Java {.no-header}
å‡½æ•°å(ä¼ å…¥çš„å‚æ•°åˆ—è¡¨)
```

---

å‡½æ•°ä¹Ÿå¯ä»¥æœ‰å¤šä¸ªå‚æ•°ï¼š
```Java
// å®šä¹‰å†™åœ¨public class xxx { ... }é‡Œ
static int add(int a, int b) {
    System.out.println("ä¼ å…¥çš„aæ˜¯ï¼š" + a);
    System.out.println("ä¼ å…¥çš„bæ˜¯ï¼š" + b);
    return a + b;
}

// åœ¨mainå‡½æ•°ä¸­è°ƒç”¨ï¼š
int sum = add(3, add(2, 2)); // sum = 7
```

---

å‡½æ•°ä¹Ÿå¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼š
```Java
// æ‰“å°é—®å€™è¯­ï¼Œæ²¡æœ‰è¿”å›å€¼
static void greet(String name) {
    System.out.println("Hello, " + name + "!");
}

// åœ¨mainå‡½æ•°ä¸­è°ƒç”¨
greet("Alex"); // è¾“å‡º: Hello, Alex!
```

```Java
void modify(List<String> lst) {
    lst.add("Bob"); // ä¿®æ”¹å¯¹è±¡å†…å®¹
}

void anotherModify(List<String> lst) {
    lst = List.of("Steve"); // ç»‘å®šä¸€ä¸ªæ–°çš„å¯¹è±¡
}

public static void main(String[] args) {
    List<String> names = new ArrayList<>();
    names.add("Alice");
    modify(a);
}
```

å‡½æ•°è°ƒç”¨æ—¶ä¼ é€’å‚æ•°ï¼šç»‘å®šåˆ°åŒä¸€ä¸ªå¯¹è±¡

```mermaid
graph TD

    listObj["[Alice]"]
    style listObj fill:#c6efce

    subgraph main
        names["names"]
    end

    subgraph modify
        lst["lst"]
    end

    names --> listObj
    lst --> listObj
```

ä½¿ç”¨`.add()`ä¿®æ”¹åï¼š
```mermaid
graph TD

    listObj["[Alice, Bob]"]
    style listObj fill:#c6efce

    subgraph main
        names["names"]
    end

    subgraph modify
        lst["lst"]
    end

    names --> listObj
    lst --> listObj
```

è°ƒç”¨`anotherModify`æ—¶ï¼š

```mermaid
graph TD

    listObj["[Alice, Bob]"]
    style listObj fill:#c6efce

    subgraph main
        names["names"]
    end

    subgraph anotherModify
        lst["lst"]
    end

    names --> listObj
    lst --> listObj
```

`lst`ç»‘å®šåˆ°æ–°çš„å¯¹è±¡ä¸Šï¼Œä¸å½±å“`names`ï¼š

```mermaid
graph TD

    listObj["[Alice, Bob]"]
    listObj2["[Steve]"]
    style listObj fill:#c6efce
    style listObj2 fill:#c6efce

    subgraph main
        names["names"]
    end

    subgraph anotherModify
        lst["lst"]
    end

    names --> listObj
    lst --> listObj2
```

## Lambdaï¼šå°†å‡½æ•°ä½œä¸ºå€¼

æŒæ¡äº†å‡½æ•°çš„åŸºæœ¬ç”¨æ³•ï¼Œä½ å¯èƒ½ä¼šé—®ï¼Œä¸€ä¸ªå‡½æ•°èƒ½ä½œä¸ºå‚æ•°ä¼ å…¥å¦ä¸€ä¸ªå‡½æ•°é‡Œå—ï¼Ÿè‡ªç„¶å¯ä»¥ï¼è®©æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥æ¥ã€‚

### å°†å‡½æ•°èµ‹å€¼ç»™å˜é‡

ç”±äºå†å²åŒ…è¢±ï¼Œåƒæˆ‘ä»¬ä¹‹å‰é‚£æ ·å®šä¹‰çš„æ™®é€šå‡½æ•°ï¼Œå®ƒçš„å‡½æ•°åå¹¶ä¸èƒ½ä½œä¸ºå˜é‡è¢«ä½¿ç”¨ï¼š

```Java
static int square(int x) {
    return x * x;
}

public static void main(String[] args) {
    // å‡è®¾funcæ˜¯ä¸€ä¸ªä»¥å‡½æ•°ä¸ºå‚æ•°çš„å‡½æ•°
    func(square); // æŠ¥é”™ï¼ä½ ä¸èƒ½è¿™ä¹ˆå†™
}
```

ç›¸åï¼Œè¦å°†å‡½æ•°å˜æˆä¸€ä¸ªå¯ä»¥éšå¤„ä¼ é€’çš„å€¼ï¼Œæœ‰å¦ä¸€å¥—ç›¸è¿‘çš„è¯­æ³•ï¼Œæˆ‘ä»¬å«å®ƒ **Lambda**ï¼š
```Java {.no-header}
å‚æ•°åç§° æˆ– () -> è¿”å›å€¼ æˆ– { ... }
```

ä¾‹å¦‚ï¼š

```Java {.no-header}
(a) -> a * a

name -> {
    System.out.println("Hello, " + name + "!");
}
```

ç„¶è€Œï¼Œå•è¿™ä¹ˆå†™ï¼ŒJavaæ— æ³•åˆ¤æ–­å…¶ç±»å‹ï¼Œå¿…é¡»æ‰‹åŠ¨æ³¨æ˜æˆ–ä»ä¸Šä¸‹æ–‡æ¨æ–­ã€‚æœ€ç®€å•çš„æ–¹æ³•å½“ç„¶æ˜¯å°†å®ƒä¸ç‰¹å®šç±»å‹çš„å˜é‡ç»‘å®šã€‚

é‚£ä¹ˆï¼Œå¯¹äºä¸åŒå‚æ•°å’Œè¿”å›å€¼çš„å‡½æ•°ï¼Œå®ƒçš„ç±»å‹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå¸¸è§çš„æœ‰ä¸‹é¢å‡ ç§ï¼š

| ç±»å‹             | å‚æ•°ç±»å‹ | è¿”å›å€¼ç±»å‹ | è°ƒç”¨æ–¹å¼             |
| -------------- | ---- | ----- | ---------------- |
| Runnable       | 0    | æ—      | `.run()`         |
| Supplier\<R>   | 0    | R     | `.get()`         |
| Consumer\<T>   | T    | æ—      | `.accept(ä¼ å…¥çš„å‚æ•°)` |
| Function<T, R> | T    | R     | `.apply(ä¼ å…¥çš„å‚æ•°)`  |

#### Runnable

`Runnable`æ˜¯æŒ‡æ²¡æœ‰å‚æ•°ï¼Œä¹Ÿæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯ä¸€ä¸ªå¯ä»¥æ‰§è¡Œçš„ä»»åŠ¡ï¼š

```Java
Runnable sayHi = () -> System.out.println("Hiï¼");
sayHi.run(); // è¾“å‡º: Hiï¼
```

#### Supplier

`Supplier<R>`æ˜¯æŒ‡æ²¡æœ‰å‚æ•°ï¼Œä½†æœ‰è¿”å›å€¼ï¼ˆç±»å‹ä¸º`R`ï¼‰çš„å‡½æ•°ï¼Œçœ‹èµ·æ¥å°±åƒæ˜¯å®ƒä¸ºä½ æä¾›äº†ä¸€ä¸ªå€¼ï¼š

```Java
import java.util.function.Supplier

Supplier<Integer> randomNumber = () -> (int)(Math.random() * 100); // Javaå¯ä»¥è‡ªåŠ¨å°† int ç±»å‹åŒ…è£…æˆ Integer
System.out.println(randomNumber.get()); // äº§ç”Ÿä¸€ä¸ª 1 è‡³ 99 çš„éšæœºæ•°
```

> [!NOTE]
> ä¸å¹¸çš„æ˜¯ï¼Œç”±äºJavaçš„å†å²åŒ…è¢±ï¼Œä½ ä¸èƒ½åœ¨`R`å¤„å†™ç±»ä¼¼äº`int`ã€`char`ä¹‹ç±»çš„åŸºæœ¬ç±»å‹ï¼Œè€Œæ˜¯è¦å†™`Integer`ã€`Char`ç­‰ï¼ˆé™¤äº†`int`ï¼Œéƒ½æ˜¯æŠŠé¦–å­—æ¯å¤§å†™ï¼‰ã€‚å¯¹äºå¼•ç”¨ç±»å‹ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

#### Consumer

`Consumer<T>`æ˜¯æŒ‡æœ‰ä¸€ä¸ªç±»å‹ä¸º`T`çš„å‚æ•°ï¼Œæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°ã€‚

```Java
import java.util.function.Consumer;

Consumer<String> greet = name -> System.out.println("Hello, " + name + "!");

greet.accept("Alex"); // è¾“å‡º: Hello, Alex!
```

#### Function

`Function<T, R>`æ˜¯æŒ‡ï¼Œæœ‰ä¸€ä¸ªç±»å‹ä¸º`T`çš„å‚æ•°ï¼Œè¿”å›å€¼ä¸º`R`çš„å‡½æ•°ã€‚

```Java
import java.util.function.Function;

Function<Integer, Integer> square = x -> x * x;
System.out.println(square.apply(5)); // è¾“å‡º 25
```

> [!NOTE] æ›´å¤šç±»å‹
> + `Predicate<T>`ï¼šå…¶å®å°±æ˜¯`Function<T, Boolean>`
> + `BiFunction<T, U, R>`ï¼šåŒå‚æ•°çš„å‡½æ•°
> + ç±»ä¼¼çš„`BiConsumer`ç­‰
### å°†å‡½æ•°ä½œä¸ºå‚æ•°ä¸è¿”å›å€¼

å‡è®¾æˆ‘ä»¬éœ€è¦è®¾è®¡è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼šå®ƒèƒ½å¤Ÿé‡å¤æ‰§è¡Œå¦ä¸€ä¸ªå‡½æ•°`n`æ¬¡ï¼Œä¸éš¾æƒ³åˆ°ï¼Œè¿™ä¸ªå‡½æ•°å¿…é¡»è¦ä»¥å¦ä¸€ä¸ªå‡½æ•°ä¸ºå‚æ•°ã€‚å¾ˆå®¹æ˜“å†™å‡ºä¸‹é¢è¿™ä¸ªç‰ˆæœ¬ï¼š

```Java {data-open=true}
import java.util.function.Consumer;

public class Main {
    // repeat å‡½æ•°ï¼šæ¥å—ä¸€ä¸ªåŠ¨ä½œå’Œé‡å¤æ¬¡æ•°
    static void repeat(int n, Consumer<Integer> action) {
        for (int i = 0; i < n; i++) action.accept(i); // è°ƒç”¨ä¼ å…¥çš„å‡½æ•°
    }

    public static void main(String[] args) {
        Consumer<Integer> printNumber = n -> System.out.println("æ‰§è¡Œæ¬¡æ•°ï¼š" + n);

        // è°ƒç”¨ repeatï¼Œé‡å¤æ‰§è¡Œ 5 æ¬¡
        repeat(5, printNumber);
        // ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ Lambda ä½œä¸ºå‚æ•°
        repeat(3, n -> System.out.println("ç›´æ¥æ‰§è¡Œæ¬¡æ•°ï¼š" + n));
    }
}
```

ç„¶è€Œï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦æ‰§è¡ŒåŒä¸€ä¸ªåŠ¨ä½œä¸åŒçš„æ¬¡æ•°ï¼Œæˆ‘ä»¬éœ€è¦å†™ï¼š
```Java {.no-header}
repeat(3, printNumber);
repeat(5, printNumber);
repeat(10, printNumber);
```
æœªå…æœ‰äº›éº»çƒ¦ã€‚é€šè¿‡è§‚å¯Ÿå‘ç°ï¼Œè¿™é‡Œæœ‰é‡å¤çš„é€»è¾‘ï¼Œé‚£å°±æ˜¯`repeat(n, printNumber)`ä¸­ï¼Œåªæœ‰æ¬¡æ•°`n`åœ¨å˜åŒ–ã€‚å¦‚æœèƒ½åªå†™ä¸€æ¬¡åŠ¨ä½œï¼Œè€Œé‡å¤æ¬¡æ•°å¯ä»¥éšæ—¶å˜åŒ–ï¼Œä¼šä¸ä¼šæ›´æ–¹ä¾¿ï¼Ÿ

æ¢å¥è¯è¯´ï¼Œæˆ‘æƒ³è¿™æ ·è°ƒç”¨ï¼š`repeatPrint(5)`ã€‚\
è¿™ä¸ª`repeatPrint`å‡½æ•°å¹²äº†ä»€ä¹ˆå‘¢ï¼Ÿè¾“å…¥ä¸€ä¸ªæ¬¡æ•°`n`ï¼Œæ‰§è¡Œ`repeat(n, printNumber)`ï¼Œæ˜¾ç„¶ï¼Œè¿™æ˜¯ä¸€ä¸ª`Consumer<Integer>`ã€‚ä¹Ÿå°±æ˜¯ï¼š
```Java {.no-header}
Consumer<Integer> repeatPrint = n -> repeat(n, printNumber);
```
è®©æˆ‘ä»¬æ›´è¿›ä¸€æ­¥ï¼Œå‡è®¾æˆ‘ç°åœ¨éœ€è¦æ‰§è¡Œçš„åŠ¨ä½œä¹Ÿå˜å¾—å¤šäº†èµ·æ¥ï¼š
```Java {.no-header}
Consumer<Integer> repeatPrint = n -> repeat(n, printNumber);
Consumer<Integer> repeatPrint2 = n -> repeat(n, printNumber2);
...
```
èƒ½ä¸èƒ½æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œè®©æˆ‘èƒ½å¤Ÿæ–¹ä¾¿åœ°å¾—åˆ°`repeatXXX`ï¼Ÿå°±åƒè¿™æ ·ï¼š
```Java {.no-header}
Consumer<Integer> repeatPrint = makeRepeat(printNumber);
```
æˆ‘ä»¬è¿˜æ˜¯ä»`makeRepeat`å…¥æ‰‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªä»¥`Consumer<Integer>`ä¸ºå‚æ•°ï¼Œè¿”å›`Consumer<Integer>`çš„å‡½æ•°ï¼Œè‡ªç„¶å¯ä»¥å†™ï¼š

```Java {.no-header}
Consumer<Integer> makeRepeat(Consumer<Integer> action) {
    return n -> repeat(n, action);
}
```

è®©æˆ‘ä»¬æ¥çœ‹è¿™ä¸ªå®Œæ•´çš„ä¾‹å­ï¼š

```Java {data-open=true}
import java.util.function.Consumer;

public class Main {
    // åŸå§‹ repeat å‡½æ•°ï¼šé‡å¤æ‰§è¡ŒåŠ¨ä½œ n æ¬¡
    static void repeat(int n, Consumer<Integer> action) {
        for (int i = 0; i < n; i++) action.accept(i);
    }

    // makeRepeatï¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶é‡å¤æ¬¡æ•° nï¼Œæ‰§è¡Œ repeat
    static Consumer<Integer> makeRepeat(Consumer<Integer> action) {
        return n -> repeat(n, action);
    }

    public static void main(String[] args) {
        // å®šä¹‰ä¸åŒçš„åŠ¨ä½œ
        Consumer<Integer> printNumber = n -> System.out.println("æ‰§è¡Œæ¬¡æ•°ï¼š" + n);
        Consumer<Integer> printSquare = n -> System.out.println("å¹³æ–¹ï¼š" + n * n);

        // ä½¿ç”¨ makeRepeat ç”Ÿæˆ repeatXXX
        Consumer<Integer> repeatPrint = makeRepeat(printNumber);
        Consumer<Integer> repeatSquare = makeRepeat(printSquare);

        // è°ƒç”¨é—­åŒ…å‡½æ•°ï¼Œä¼ å…¥æ¬¡æ•°
        repeatPrint.accept(3);
        repeatSquare.accept(5);
    }
}
```

å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿæˆ‘ä»¬å‘ç°ï¼Œ`makeRepeat` æ¥æ”¶ä¸€ä¸ªåŠ¨ä½œ `action`ï¼Œè¿”å›ä¸€ä¸ªæ–°å‡½æ•°ï¼š`n -> repeat(n, action)`\
è¿™ä¸ªâ€œæ–°å‡½æ•°â€ä»¥åè¢«è°ƒç”¨æ—¶ï¼Œä»ç„¶èƒ½ç”¨åˆ°å½“åˆä¼ è¿›æ¥çš„ `action`ã€‚

åœ¨ `makeRepeat` é‡Œï¼Œè¿”å›çš„å‡½æ•°æ•è·äº† `makeRepeat` å¤–éƒ¨çš„ `action`ï¼›å³ä½¿ `makeRepeat` æ—©å°±æ‰§è¡Œå®Œäº†ï¼Œä¼ å…¥çš„`action`ä¹Ÿå·²ç»ç¦»å¼€äº†å®ƒçš„ä½œç”¨åŸŸï¼Œè¿”å›çš„å‡½æ•°ä»ç„¶è®°å¾— `action`ã€‚

è¿™å°±æ˜¯**é—­åŒ…**â€”â€”å‡½æ•°å¸¦ç€å®ƒè¯ç”Ÿæ—¶çš„ç¯å¢ƒã€‚

`repeatPrint`ã€`repeatSquare`ä¸¤ä¸ªè¿”å›çš„å‡½æ•°â€œé•¿å¾—åƒâ€ï¼Œä½†å„è‡ªæºå¸¦çš„ `action` ä¸åŒï¼Œå› æ­¤è¡Œä¸ºä¸åŒâ€”â€”è¿™æ­£æ˜¯é—­åŒ…çš„åŠ›é‡ã€‚

### é—­åŒ…

åº†å¹¸çš„æ˜¯ï¼ŒJavaçš„å†å²åŒ…è¢±è¿˜æ²¡æœ‰æ²‰é‡åˆ°è¿é—­åŒ…éƒ½ä¸èƒ½æ”¯æŒã€‚

```Java {data-open=true}
import java.util.function.Consumer;

public class Main {
    public static void main(String[] args) {
        // å¤–éƒ¨å˜é‡ï¼šåŠ¨ä½œ
        Consumer<Integer> printNumber = n -> System.out.println("æ‰§è¡Œæ¬¡æ•°ï¼š" + n);

        // é—­åŒ…ï¼šè¿”å›å‡½æ•°ï¼Œåªéœ€è¦æä¾›æ¬¡æ•° nï¼ŒåŠ¨ä½œå·²ç»è¢«æ•è·
        Consumer<Integer> repeatPrint = n -> {
            for (int i = 0; i < n; i++) printNumber.accept(i); // è‡ªåŠ¨æ•è·äº† printNumber
        };

        // è°ƒç”¨é—­åŒ…
        repeatPrint.accept(3);
    }
}
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ`repeatPrint` å°±æ˜¯ä¸€ä¸ªé—­åŒ…ã€‚å®ƒæ•è·äº†å¤–éƒ¨å˜é‡ `printNumber`ï¼Œæ‰€ä»¥å³ä½¿åœ¨å‡½æ•°å†…éƒ¨æ²¡æœ‰æ˜¾å¼ä¼ å…¥åŠ¨ä½œï¼Œä¹Ÿèƒ½ä½¿ç”¨å®ƒã€‚

> [!NOTE] é—­åŒ…
> é—­åŒ… = å‡½æ•° + åˆ›å»ºå‡½æ•°æ—¶æ•è·çš„ç¯å¢ƒ
> 
> æ¢å¥è¯è¯´ï¼Œé—­åŒ…ä¼šè®°ä½å®ƒè¢«åˆ›å»ºæ—¶å¯ç”¨çš„å˜é‡ï¼Œå³ä¾¿å‡½æ•°å·²ç»è¿”å›æˆ–ä½œç”¨åŸŸç»“æŸã€‚

---

ç„¶è€Œï¼Œè¢«é—­åŒ…æ•è·çš„å˜é‡ä¸èƒ½å†è¿›è¡Œèµ‹å€¼ï¼ˆå¦‚æœä½ å®åœ¨æƒ³æ•è·å¯å˜å˜é‡ï¼Œä¸å¦¨ç”¨å®¹å™¨åŒ…è£…å®ƒï¼Œä½†æ˜¯å¹¶ä¸æ¨èï¼‰ï¼š

```Java
int base = 10; // å±€éƒ¨å˜é‡
Consumer<Integer> c = n -> System.out.println(base + n);
base = 20; // æŠ¥é”™ï¼
```

---

```Java {data-open=true}
import java.util.function.Consumer;

public class Main {
    // ç”Ÿæˆæ‰“å°åŠ¨ä½œçš„é—­åŒ…
    static Consumer<Integer> LoggerBuilder(String prefix) {
        // å±€éƒ¨å˜é‡ prefix è¢«é—­åŒ…æ•è·ï¼Œé—­åŒ…å¯ä»¥è®¿é—®å®ƒ
        return n -> System.out.println(prefix + "å€¼: " + n);
    }

    public static void main(String[] args) {
        // ç”Ÿæˆé—­åŒ…
        Consumer<Integer> attackCallback = LoggerBuilder("[æ”»å‡»] ");
        Consumer<Integer> healCallback = LoggerBuilder("[æ²»ç–—] ");

        // æ¨¡æ‹Ÿäº‹ä»¶è¢«è§¦å‘ï¼ˆåœ¨çœŸå®å¼€å‘ä¸­ï¼Œå½“æŸäº›æ¡ä»¶æ»¡è¶³æ—¶ï¼Œå°†ä¼šè‡ªåŠ¨è°ƒç”¨triggerActionï¼‰
        triggerAction(attackCallback, 10);
        triggerAction(healCallback, 5);
        triggerAction(attackCallback, 20);
    }

    // æ¨¡æ‹Ÿè§¦å‘å‡½æ•°
    static void triggerAction(Consumer<Integer> callback, int value) {
        System.out.println("=== ç©å®¶åŠ¨ä½œè§¦å‘ ===");
        callback.accept(value);
    }
}
```

è¿™æ˜¯é—­åŒ…çš„ä¸€ä¸ªç»å…¸ç”¨æ³•ï¼š`attackCallback`å’Œ`healCallback`éƒ½æ˜¯é—­åŒ…ï¼Œæˆ‘ä»¬å¾€å¾€å¹¶ä¸æ˜¯ç«‹åˆ»æ‰§è¡Œé—­åŒ…ä¸­çš„é€»è¾‘ï¼Œè€Œæ˜¯å¸Œæœ›å½“æŸäº›äº‹ä»¶å‘ç”Ÿåï¼Œè‡ªåŠ¨æ‰§è¡Œå®ƒä»¬ã€‚

## æ–¹æ³•å¼•ç”¨

åˆšæ‰ï¼Œæˆ‘ä»¬å­¦ä¹ äº† Lambda è¡¨è¾¾å¼ï¼Œå®ƒè®©å‡½æ•°å¯ä»¥ä½œä¸ºå€¼ä¼ é€’ï¼Œå¹¶å¯ä»¥è½»æ¾åˆ›å»ºé—­åŒ…ã€‚

æœ‰æ—¶å€™ï¼Œä¸€ä¸ª Lambda è¡¨è¾¾å¼éå¸¸ç®€å•ï¼Œåªæ˜¯è°ƒç”¨ä¸€ä¸ªå·²æœ‰çš„æ–¹æ³•ã€‚ä¸ºäº†è®©ä»£ç æ›´ç®€æ´ã€å¯è¯»ï¼ŒJava æä¾›äº†æ–¹æ³•å¼•ç”¨ï¼Œå®ƒæ˜¯ Lambda çš„ç®€å†™ã€‚

> [!TIPS]- æ³¨
> ç”±äºæˆ‘ä»¬è¿˜æ²¡æœ‰æ·±å…¥å­¦ä¹ Javaçš„ç±»å’Œå¯¹è±¡ï¼Œåœ¨æœ¬ç« ï¼Œæˆ‘ä»¬åªä½¿ç”¨ç³»ç»Ÿæä¾›çš„å¯¹è±¡æˆ–é™æ€æ–¹æ³•ï¼Œä¸æ¶‰åŠè‡ªå®šä¹‰ç±»å’Œå¯¹è±¡ã€‚

æ–¹æ³•å¼•ç”¨ç‚¹å†™æ³•å¾ˆç®€å•ï¼š
```Java {.no-header}
ç±»æˆ–å¯¹è±¡::æ–¹æ³•å
```

### å¼•ç”¨å¯¹è±¡çš„æ–¹æ³•

```Java {data-open=true}
public class Main {
    public static void main(String[] args) {
        String[] items = {"WOOD", "STONE", "IRON"};

        // ä½¿ç”¨ Lambda æ‰“å°æ¯ä¸ªå…ƒç´ 
        for (String item : items) {
            Runnable r = () -> System.out.println(item); // è‡ªåŠ¨æ•è·å¤–éƒ¨å˜é‡
            r.run();
        }

        // ä½¿ç”¨æ–¹æ³•å¼•ç”¨ï¼ˆSystem.out æ˜¯ Java å†…ç½®å¯¹è±¡ï¼Œprintln æ˜¯å®ƒçš„ä¸€ä¸ªæ–¹æ³•ï¼‰
        for (String item : items) {
            Consumer<String> r = System.out::println;
            r.accept(item);
        }
    }
}
```

### å¼•ç”¨ç±»çš„æ–¹æ³•

```Java {data-open=true}
import java.util.function.Consumer;

public class Main {
    // é™æ€æ–¹æ³•
    static void printItem(String s) {
        System.out.println(s);
    }

    public static void main(String[] args) {
        String[] items = {"WOOD", "STONE", "IRON"};

        // Lambda
        Consumer<String> p1 = s -> printItem(s);
        for (String item : items) p1.accept(item);

        // æ–¹æ³•å¼•ç”¨
        Consumer<String> p2 = Main::printItem;
        for (String item : items) p2.accept(item);
    }
}
```
## æµ

> [!NOTE] ä»€ä¹ˆæ˜¯å¯¹è±¡
> åœ¨ Java ä¸­ï¼Œæˆ‘ä»¬ä¹‹å‰æ¥è§¦çš„å€¼å’Œå‡½æ•°éƒ½æ˜¯æ¯”è¾ƒâ€œç‹¬ç«‹â€çš„ï¼šä¸€ä¸ªå˜é‡å­˜å‚¨ä¸€ä¸ªå€¼ï¼Œä¸€ä¸ªå‡½æ•°æ‰§è¡Œä¸€ä¸ªæ“ä½œã€‚ä½†å®é™…ä¸Šï¼Œåœ¨Javaä¸­ï¼Œå‡ ä¹æ‰€æœ‰å€¼éƒ½å¯ä»¥è¢«è§†ä¸ºæŸç§å¯¹è±¡â€”â€”å¯¹è±¡å¯ä»¥ç†è§£ä¸ºå¸¦æœ‰è¡Œä¸ºçš„å€¼ã€‚
> ä½ å¯¹â€œå¯¹è±¡å¸¦æœ‰è¡Œä¸ºâ€åº”å½“å¹¶ä¸é™Œç”Ÿï¼š
> ```Java {.no-header}
> System.out.println( ... )
> ```
> è¿™é‡Œçš„`out`å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ`println`å°±æ˜¯å®ƒå¸¦æœ‰çš„ä¸€ä¸ªè¡Œä¸ºï¼Œä½ å¯ä»¥å«å®ƒè¡Œä¸ºï¼Œæ–¹æ³•ï¼Œæˆ–æ˜¯å‡½æ•°ï¼Œéƒ½æ˜¯åŒæ ·çš„æ„æ€ã€‚
> ä¸è®ºæ€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨`.`æ¥è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰çš„æ–¹æ³•ã€‚å€˜è‹¥è¿™ä¸ªæ–¹æ³•çš„è¿”å›å€¼åˆæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥ï¼š
> ```Java {.no-header}
> å¯¹è±¡.æ–¹æ³•ä¸€( ... ).æ–¹æ³•äºŒ( ... ).æ–¹æ³•ä¸‰( ... )......
> ```
> è¿™å°±æ˜¯**é“¾å¼è°ƒç”¨**

åœ¨å‰é¢æˆ‘ä»¬å­¦ä¹ äº† Lambda è¡¨è¾¾å¼ã€é—­åŒ…å’Œæ–¹æ³•å¼•ç”¨ï¼Œå®ƒä»¬è®©å‡½æ•°å¯ä»¥ä½œä¸ºå€¼è¢«ä¼ é€’å’Œç»„åˆã€‚\
æ¥ä¸‹æ¥ï¼ŒStream API æ˜¯ Java æä¾›çš„ä¸€ç§å‡½æ•°å¼å¤„ç†é›†åˆçš„å·¥å…·ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç”¨ç®¡é“å¼æ“ä½œå¤„ç†åˆ—è¡¨ã€æ•°ç»„ç­‰æ•°æ®ç»“æ„ã€‚

> [!NOTE]
`Stream<T>` ä¸æ˜¯å­˜å‚¨æ•°æ®çš„å®¹å™¨ï¼Œå®ƒåªæ˜¯â€œæ•°æ®æ“ä½œçš„ç®¡é“â€ã€‚å®ƒæœ¬èº«ä¸æ”¹å˜åŸé›†åˆï¼Œåªåœ¨ç»ˆç«¯æ“ä½œæ—¶æ‰æ‰§è¡Œè®¡ç®—ã€‚

> [!TIPS]- è¿™ä¹ˆå¤šå‡½æ•°åˆ°åº•è°è®°å¾—ä½å•ŠğŸ˜¡
> ä¸‹é¢å°†ä¼šå‡ºç°å¾ˆå¤šæ–¹æ³•ï¼Œçœ‹æ‡‚ï¼Œå¹¶ä¸”çŸ¥é“ `Stream` èƒ½å®ç°ä»€ä¹ˆåŠŸèƒ½å³å¯ï¼Œéœ€è¦ä½¿ç”¨æ—¶å¯ä»¥å†ç¿»é˜…æˆ–è¯¢é—®AI
### åˆ›å»ºæ“ä½œ

åˆ›å»º `Stream` æ˜¯æ“ä½œæ•°æ®çš„ç¬¬ä¸€æ­¥ã€‚å¯¹äºéæ•°ç»„çš„é›†åˆç±»å‹ï¼Œä½ å¯ä»¥ç”¨`.stream()`å¾ˆæ–¹ä¾¿åœ°åˆ›å»ºæµï¼š

```Java {.no-header}
List<String> items = List.of("WOOD", "STONE", "IRON");

// ä» List åˆ›å»ºé¡ºåºæµ
Stream<String> stream1 = items.stream();
// ä» List åˆ›å»ºå¹¶è¡Œæµ
Stream<String> stream2 = items.parallelStream();
```

å¯¹äºæ•°ç»„ï¼Œä½ éœ€è¦ä½¿ç”¨`Arrays.stream( ... )`ï¼š
```Java {.no-header}
String[] ss = {"APPLE", "GOLD", "DIAMOND"}
Stream<String> stream3 = Arrays.stream(ss);
```

--- 

`Stream`è¿˜æä¾›äº†ä¸€äº›æ–¹æ³•ç›´æ¥åˆ›å»ºæµï¼Œä¾‹å¦‚ï¼š

+ ä»å…ƒç´ ç›´æ¥åˆ›å»ºæµ
```Java {.no-header}
Stream<String> stream3 = Stream.of("DIAMOND", "GOLD", "APPLE");
```
+ ä»æ— å‚å‡½æ•°`Supplier<T>`åˆ›å»ºæµ
```Java {.no-header}
// åˆ›å»ºéšæœºæ•°æµ
Stream<Double> randomNumbers = Stream.generate(Math::random);
```
> [!TIPS] 
> å¾€å¾€ç”¨æ¥ç”Ÿæˆå›ºå®šå€¼ã€éšæœºæ•°
+ ä»åˆå§‹å€¼å’Œé€’æ¨å‡½æ•°åˆ›å»ºæµ
```Java {.no-header}
// åˆ›å»ºæµï¼š0, 2, 4, 6...
Stream<Integer> evenNumbers = Stream.iterate(0, n -> n + 2);
```

### ç»ˆç«¯æ“ä½œ

ç»ˆç«¯æ“ä½œä¼šå¯åŠ¨æ•´ä¸ªæµçš„è®¡ç®—ï¼Œå¹¶è¿”å›æœ€ç»ˆç»“æœæˆ–äº§ç”Ÿå‰¯ä½œç”¨ã€‚
#### éå†
+ `.forEach(Consumer)`ï¼šå¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡ŒåŠ¨ä½œ
```Java
// æ‰“å°æ¯ä¸ªå…ƒç´ 
items.stream().forEach(System.out::println);
```
#### ç»Ÿè®¡æ”¶é›†
+ `.count()`ï¼šç»Ÿè®¡å…ƒç´ æ•°é‡
+ `.collect(Collector)`ï¼šå°†æµè½¬æ¢åˆ°å…¶ä»–å½¢å¼ï¼Œä¾‹å¦‚ `List`ã€`Set`ã€`Map` ç­‰
+ `.toList()`ï¼šå°†æµè½¬æ¢ä¸º `List`
```Java
import java.util.stream.Collectors;

List<String> items = List.of("WOOD", "STONE", "IRON");
// æ— äº‹å‘ç”Ÿ
List<String> alsoItems = items.stream()â€‹.collect(Collectors.toList());
// è¿™ä¸å°±æ˜¯items.size()å—ğŸ˜ 
long c = items.stream().count();
```

#### åŒ¹é…æŸ¥æ‰¾

+ `.anyMatch` / `.allMatch` / `.noneMatch` `(Predicate)`ï¼šå½“ä»»æ„/æ‰€æœ‰/æ²¡æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶æ—¶è¿”å›`True`
+ `.findFirst()`ï¼šè·å–æµä¸­ç¬¬ä¸€ä¸ªå…ƒç´ 

```Java
List<String> items = List.of("WOOD", "STONE", "IRON").stream();

boolean hasIron = items.stream().anyMatch(s -> s.equals("IRON")); // true

Optional<String> first = items.stream().findFirst(); // Steamå¯èƒ½æ²¡æœ‰å…ƒç´ 
System.out.println(first.orElse("æµä¸­æ²¡æœ‰å…ƒç´ ï¼")); // WOOD
```

#### èšåˆ

+ `.reduce(åˆå§‹å€¼, å½’çº¦å‡½æ•°)`ï¼šç”¨ä¸€ä¸ªå½’çº¦å‡½æ•°æŠŠæ•´ä¸ªåˆ—è¡¨â€œèšåˆâ€æˆä¸€ä¸ªå€¼ï¼Œè€Œä¸éœ€è¦æ˜¾å¼å¾ªç¯ã€‚å½’çº¦å‡½æ•°æ˜¯æŒ‡ç”¨äºå°†å½“å‰ç´¯ç§¯å€¼å’Œæµä¸­ä¸‹ä¸€ä¸ªå…ƒç´ åˆå¹¶ï¼Œå¾—åˆ°æ–°çš„ç´¯ç§¯å€¼çš„å‡½æ•°ã€‚
+ `.reduce(å½’çº¦å‡½æ•°)`ï¼šè¿”å›`Optional<T>`

```Java
Stream<Integer> numbers = Stream.of(1, 2, 3, 4, 5);

int sum = numbers.reduce(0, (a, b) -> a + b); // 15
```
### ä¸­é—´æ“ä½œ

ä¸­é—´æ“ä½œä¼šè¿”å›ä¸€ä¸ªæ–°çš„ `Stream`ï¼ˆä¸ä¼šæ‰§è¡Œè®¡ç®—ï¼‰ï¼Œå¯ä»¥é“¾å¼ç»„åˆï¼Œå¸¸ç”¨æ“ä½œå¦‚ä¸‹ï¼š
#### æˆªå–

+ `.limit(n)`ï¼šå–å‰`n`ä¸ªå…ƒç´ 
+ `.skip(n)`ï¼šè·³è¿‡å‰`n`ä¸ªå…ƒç´ 

```Java
// åŒ…å«5ä¸ªéšæœºæ•°çš„æµ
Stream<Double> randomStream5 = Stream.generate(Math::random).limit(5);
```

#### æ’åº

+ `sorted()`ï¼šä»å°åˆ°å¤§æ’åº
+ `sorted(Comparator)`ï¼šæŒ‰ç…§ç»™å®šçš„æ¯”è¾ƒå‡½æ•°æ’åº

```Java
// ä»å°åˆ°å¤§æ’åº
Stream<Integer> s1 = Stream.of(3, 1, 2).sorted(); // 1, 2, 3
// ä»å¤§åˆ°å°æ’åº
Stream<Integer> s2 = Stream.of(3, 1, 2).sorted((p, q) -> p - q); // 3, 2, 1
```

#### è¿‡æ»¤
+ `filter(Predicate)`ï¼šç­›é€‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ 
+ `distinct()`ï¼šå»é‡

```Java

List<String> items = List.of("WOOD", "STONE", "IRON", "STONE");
// é€‰å‡ºå­—ç¬¦ä¸²é•¿åº¦å¤§äº4çš„å…ƒç´ å¹¶å»é‡ï¼Œç„¶åè½¬å›List
List<String> newItems = items.stream().filter(s -> s.length() > 4).distinct().toList(); // "STONE"
```

#### æ˜ å°„

+ `.map(Function)`ï¼šå°†ç»™å®šå‡½æ•°åº”ç”¨äºæ¯ä¸ªå…ƒç´ 

```Java
List<String> items = List.of("WOOD", "STONE", "IRON");
// è½¬åŒ–ä¸ºå°å†™å¹¶è¾“å‡º
items.stream().map(String::toLowerCase).forEach(System.out::println); // wood stone iron
```

### å®ä¾‹

åœ¨ Minecraft Mod å¼€å‘ä¸­ï¼Œä¸€ä¸ªå¸¸è§çš„å·¥ä½œæ˜¯ä¸ºç‰©å“ç¼–å†™åˆæˆè¡¨ã€‚ä¸ºäº†è®© Minecraft çŸ¥é“ä½ çš„è®¾å®šï¼Œä½ éœ€è¦æä¾›ä¸€ç§ç‰¹å®šç±»å‹çš„å€¼ï¼š`Ingredient`ã€‚ç„¶è€Œï¼Œä¸ºäº†ä¾¿äºä¹¦å†™ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šç”¨ç‰©å“çš„IDï¼Œæˆ–è€…ä½ å®šä¹‰çš„ç‰©å“çš„ç±»åæ¥æè¿°åˆæˆè¡¨ã€‚

è®©æˆ‘ä»¬æ¥å†™ä¸€ä¸ªå·¥å…·å‡½æ•°ï¼ŒæŠŠæŸäº›ç‰¹å®šçš„å­—ç¬¦ä¸²è§£ææˆ`Ingredient`ï¼

+ æ ‡è¯†ç¬¦å¯èƒ½æ˜¯å•ä¸ªç‰©å“ï¼Œå¦‚ `minecraft:iron_ingot`
+ ä¹Ÿå¯èƒ½æ˜¯æ ‡ç­¾ï¼Œå¦‚ `#minecraft:planks`
+ å¯èƒ½æœ‰æ•°é‡å‰ç¼€ï¼Œå¦‚ `3minecraft:iron_ingot`ï¼Œè¡¨ç¤º 3 ä¸ªç‰©å“
+ å¯èƒ½æ˜¯å¤šé€‰é¡¹ç»„åˆï¼Œç”¨ | åˆ†éš”ï¼Œå¦‚ `minecraft:iron_ingot | modname:gold_ingot`

#### å¤„ç†å¤šé¡¹ç»„åˆ

å‡è®¾æˆ‘ä»¬ä¼ å…¥çš„æ ‡è¯†ç¬¦æ˜¯ï¼š
```Java {.no-header}
String itemIdentifier = "minecraft:iron_ingot | modname:gold_ingot";
```
ç›®æ ‡ï¼šæŠŠå®ƒæ‹†åˆ†æˆå•ä¸ªå¯å¤„ç†çš„é€‰é¡¹ï¼š
```Java {.no-header}
"minecraft:iron_ingot"
"modname:gold_ingot"
```

> [!NOTE] åˆ†å‰²å­—ç¬¦ä¸²
> `.split(...)`æ–¹æ³•å¯ä»¥ä»¥ç»™å®šçš„å†…å®¹ä¸ºåˆ†å‰²ï¼Œå°†å­—ç¬¦ä¸²æ‹†åˆ†æˆä¸€ä¸ªåˆ—è¡¨ï¼Œå¦‚ï¼š
> ```Java {.no-header}
> ["minecraft:iron_ingot", "modname:gold_ingot"]
> ```

ä¸ºäº†æ–¹ä¾¿åç»­å¤„ç†ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å®ƒå˜æˆä¸€ä¸ªæµï¼š
```Java {.no-header}
Arrays.stream(itemIdentifier.split("\\|")).map(String::trim);
```

> [!NOTE] è¿‡æ»¤ç©ºç™½å­—ç¬¦
> `.trim()`å¯ä»¥è¿‡æ»¤é¦–å°¾çš„ç©ºç™½å­—ç¬¦

#### è§£æå•ä¸ªé€‰é¡¹

æœ‰ä¸¤ç§æƒ…å†µï¼š
+ å¦‚æœä»¥ `#` å¼€å¤´ â†’ è¿™æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œè®¾è®¡ä¸€ä¸ª `parseTag` å‡½æ•°æ¥ç”Ÿæˆ `TagKey`
+ å¦åˆ™ â†’ è¿™æ˜¯æ™®é€šç‰©å“ï¼Œè°ƒç”¨æˆ‘ä»¬ä¹‹å‰åœ¨å­¦ä¹ æ­£åˆ™è¡¨è¾¾å¼æ—¶è®¾è®¡çš„ `parseItem` æ¥ç”Ÿæˆ `Item`

æˆ‘ä»¬å¯ä»¥ç”¨æ˜ å°„æ¥å®ç°ï¼šå¯¹æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œåº”ç”¨ä»¥ä¸‹æ“ä½œï¼š
```Java {.no-header}
o -> o.startsWith("#") ? Ingredient.of(parseTag(o.substring(1)) : Ingredient.of(parseItem(o))
```

> [!INFO]-
> åœ¨è¿™é‡Œéšå»äº†`Ingredient.of()`å’Œ`parseTag()`çš„å®ç°ç»†èŠ‚ï¼Œå› ä¸ºå®ƒä»¬æ¶‰åŠåˆ°äº† NeoForge æ˜¯å¦‚ä½•ç®¡ç† Minecraft èµ„æºçš„ã€‚

è¿™æ ·ï¼Œæˆ‘ä»¬å¾—åˆ°äº†`Stream<Ingredient>`
#### åˆå¹¶é€‰é¡¹

è™½ç„¶æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª`Ingredient`æµï¼Œä½†æ˜¯æˆ‘ä»¬çš„è¿”å›å€¼è¦æ±‚æ˜¯ä¸€ä¸ª`Ingredient`ã€‚

åœ¨Minecraftä¸­ï¼Œ`Ingredient.fromValues(Stream<Ingredient.Value>)`ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªåˆå¹¶çš„æ–¹æ³•ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬ç°åœ¨çš„ç›®æ ‡æ˜¯ï¼šå°†`Stream<Ingredient>`å˜æˆ`Stream<Ingredient.Value>)`ã€‚

è€Œè·å–`Value`å¾ˆç®€å•ï¼š`.getValues()`å°±å¾—åˆ°ä¸€ä¸ª`Value`æ•°ç»„

é‚£ä¹ˆï¼Œæ˜¯ä¸æ˜¯å°±å¾ˆç®€å•äº†ï¼š

```Java {.no-header}
Ingredient.fromValues(å…ˆå‰çš„ç»“æœ.map(Ingredient::getValues))
```

å½“ç„¶ä¸æ˜¯ã€‚

`Ingredient::getValues`è¿”å›çš„ç»“æœæ˜¯`Value[]`ï¼Œå› æ­¤ï¼Œç»è¿‡æ˜ å°„åçš„æµæ˜¯`Stream<Value[]>`ï¼Œè¿™ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è®©æˆ‘ä»¬å°†`Value[]`å˜æˆä¸€ä¸ªæ–°æµï¼Œå¹¶å°†å…¶æ‰å¹³åŒ–ï¼š

```Java {.no-header}
Ingredient.fromValues(å…ˆå‰çš„ç»“æœ.map(Ingredient::getValues).flatMap(Stream::of))
```

> [!INFO] æ‰å¹³åŒ–
> `flatMap` ç”¨äºå°†åµŒå¥—æµâ€œå±•å¹³â€ä¸ºå•ä¸€æµ

å®Œæ•´çš„ä»£ç å¦‚ä¸‹ï¼š

```Java {data-open=true}
public static Ingredient parseIngredient(String itemIdentifier) {
    return Ingredient.fromValues(
        Arrays.stream(itemIdentifier.split("\\|")).map(String::trim) // æ‹†åˆ†å¤šé€‰é¡¹ï¼Œå»æ‰å¤šä½™ç©ºæ ¼
            .map(o -> o.startsWith("#") ? Ingredient.of(parseTag(o.substring(1))) : Ingredient.of(parseItem(o)))
            .map(Ingredient::getValues) // å¾—åˆ° Stream<Ingredient.Value[]>
            .flatMap(Stream::of) // æ‰å¹³åŒ–æˆ Stream<Ingredient.Value>
    );
}

private static ItemStack parseItemLike(String itemIdentifier) { ... }
private static TagKey<Item> parseTag(String tagIdentifier) { ... }
```